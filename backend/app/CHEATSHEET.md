# Flask-Backend Cheat-Sheet
*(save as `CHEATSHEET.md` in the project root)*

---

## 📂 Project Layout

| Path / file                   | Purpose                                                |
|-------------------------------|--------------------------------------------------------|
| `app/__init__.py`             | Application factory `create_app()`                     |
| `app/config.py`               | `DevConfig`, `ProdConfig`, common `Config`             |
| `app/extensions.py`           | Singletons → `db`, `migrate`, `cors`                   |
| `app/models/` `*.py`          | Pure SQLAlchemy tables                                 |
| `app/routes/` `*.py`          | Blueprints – HTTP layers                               |
| `app/routes/__init__.py`      | Collects `ALL_BLUEPRINTS`                              |
| `instance/`                   | SQLite DB files (ignored by git)                       |
| `migrations/`                 | Auto-generated by Flask-Migrate                        |
| `wsgi.py`                     | WSGI entry-point (`app` variable)                      |
| `.flaskenv`                   | Dev-only env vars (`FLASK_APP`, `APP_SETTINGS=dev`)    |
| `.env.production`             | Optional prod env vars (`APP_SETTINGS=prod`)           |
| `requirements.txt`            | Pip dependencies                                       |
| `CHEATSHEET.md`               | ⇠ you’re reading it                                   |

---

## 🏃‍♂️ Run Commands

| Mode            | Command (bash)                                                              |
|-----------------|-----------------------------------------------------------------------------|
| Development     | `flask run` → auto-reload, debugger, reads `.flaskenv`                      |
| Explicit Dev    | `APP_SETTINGS=dev FLASK_ENV=development flask run`                          |
| Production test | `APP_SETTINGS=prod flask run --no-reload --host 0.0.0.0 --port 5000`        |
| Gunicorn Prod   | `APP_SETTINGS=prod gunicorn -w 4 -b 0.0.0.0:8000 wsgi:app`                  |
| Create tables   | `flask create-db` (inside venv, runs `db.create_all()`)                     |
| Auto migrations | `flask db migrate -m "msg"`  ➜  `flask db upgrade`                          |
| Python shell    | `flask shell` → objects pre-imported (`app`, `db`, `Product`, …)            |

Windows: replace inline env var (`APP_SETTINGS=…`) with `set APP_SETTINGS=…` (cmd) or `$Env:APP_SETTINGS="…"` (PowerShell).

---

## 🌳 Config Selection Logic


Change default DB, keys, etc. by editing the corresponding class in `app/config.py`.

---

┌────────────────────┐    unset / "dev" ─────────┐
│  APP_SETTINGS env  │─── "prod"/"production" ───┴─► ProdConfig (DEBUG=False)
└────────────────────┘
          │
          └─► DevConfig (DEBUG=True, auto-reload)

## 🔑 Most-used Flask-CLI shortcuts

| CLI cmd                 | What it does                                         |
|-------------------------|-------------------------------------------------------|
| `flask routes`          | List every registered endpoint & HTTP verbs          |
| `flask db revision -m`  | Create empty migration script (Alembic)              |
| `flask run --reload`    | Force code-reloader (even if `DEBUG=False`)          |

---

## ⚙️ Typical Workflow

1. `python -m venv venv && source venv/bin/activate`  
2. `pip install -r requirements.txt`  
3. `flask run` (local dev)  
4. Change models → `flask db migrate && flask db upgrade`  
5. Push to prod → `gunicorn wsgi:app` (Docker/CI sets `APP_SETTINGS=prod`)  

---

## 🐞 Common Gotchas

| Symptom                                   | Fix                                                     |
|-------------------------------------------|---------------------------------------------------------|
| “Working outside application context”     | Wrap code in `with app.app_context(): …`                |
| Duplicate tables error after refactor     | Delete old `sales.db`, then `flask create-db`           |
| Env vars not loading                      | Ensure `python-dotenv` installed (Flask default)        |
| Gunicorn shows plain 500 w/o traceback    | Check logs; ProdConfig disables debugger                |

---

## 🔗 Handy URLs

| Resource            | Link                                             |
|---------------------|--------------------------------------------------|
| Flask docs          | https://flask.palletsprojects.com                |
| SQLAlchemy docs     | https://docs.sqlalchemy.org                      |
| Flask-Migrate       | https://flask-migrate.readthedocs.io             |
| Gunicorn            | https://docs.gunicorn.org                        |

---

Happy building 🎉
